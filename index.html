<!doctype html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#000000" />
    <title>Convite ao DJ Papi party</title>

    <!-- Preload critical assets -->
    <link rel="preload" href="assets/envelope.png" as="image" />
    <link rel="preload" href="assets/perfil3.gif" as="image" />
    <link rel="preload" href="assets/music.mp3" as="audio" />

    <!-- Main stylesheet -->
    <link rel="stylesheet" href="styles/styles.css" />

    <!-- Favicon: Using emoji ðŸŽ‰ via data URL (appears in browser tab/bookmark) -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ‰</text></svg>"
      type="image/svg+xml"
    />
    <link
      rel="alternate icon"
      href="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f389.png"
      type="image/png"
      sizes="32x32"
    />

    <!-- Open Graph / Social Sharing Metadata (helps show ðŸŽ‰ when shared) -->
    <meta property="og:title" content="ðŸŽ‰ Convite ao DJ Papi Party" />
    <meta property="og:description" content="Ã‰s nosso convidado especial! DJ Papi faz 54 anos!" />
    <meta property="og:image" content="https://castrillocode.github.io/djpapi/assets/perfil3.gif" />
    <meta property="og:url" content="https://castrillocode.github.io/djpapi/" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Prevent zoom on input focus -->
    <style>
      html,
      body {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }
    </style>
  </head>
  <body>
    <!-- Intro screen with animated envelope -->
    <div id="intro-screen">
      <h2>
        Um convite especial <br />
        estÃ¡ a chegar ðŸŽ‰
      </h2>
      <img
        src="assets/envelope.png"
        alt="Click to open"
        id="envelope"
        class="envelope-img"
        loading="eager"
      />
      <div class="click-text">ðŸ‘†<br />Click</div>
      <div id="flash"></div>
    </div>

    <!-- Main content (hidden until envelope is clicked) -->
    <div id="main-content" style="display: none">
      <h1>Ã‰s nosso convidado especial</h1>
      <h2>DJ Papi faz 54 anos!</h2>

      <!-- Event animated image (GIF) -->
      <img
        src="assets/perfil3.gif"
        alt="DJ Party"
        class="event-img"
        loading="eager"
      />

      <!-- Event date -->
      <div class="dateCountdown">23 de agosto 2025 desde 21h atÃ© as 04h</div>

      <!-- Countdown timer -->
      <div class="countdown" id="countdown"></div>

      <!-- WhatsApp confirmation button -->
      <a
        class="button neon glow-border"
        href="https://wa.me/351935372796?text=Confirmo%20minha%20assistÃªncia%20e%20tomo%20conta%20das%20seguintes%20informaÃ§Ãµes%20que%20para%20a%20minha%20participaÃ§Ã£o,%20tenho%20de:%0A%E2%80%A2%20Ir%20vestido/a%20de%20branco.%0A%E2%80%A2%20Levar%20todas%20as%20minhas%20bebidas,%20gelo,%20copos%20e%20adega.%0A%E2%80%A2%20Levar%20as%20carnes%20temperadas%20que%20quiser%20fazer%20para%20o%20churrasco.%20"
        target="_blank"
      >
        Confirmar AssistÃªncia
      </a>
      <div class="notice">(AtÃ© 15 de agosto)</div>

      <!-- Location button -->
      <a
        class="button"
        href="https://maps.app.goo.gl/3v67cheJxktZ16eQ9"
        target="_blank"
      >
        EndereÃ§o: Quinta do ParaÃ­so 54
      </a>

      <!-- Footer -->
      <footer>
        Designed by
        <a href="https://www.instagram.com/rocacreatives/?hl=pt" target="_blank">
          Roca Creatives
        </a>
      </footer>

      <!-- Disco lights background effect -->
      <div class="disco-lights" id="disco-lights"></div>
    </div>

    <!-- Background music (auto-plays after user interaction) -->
    <audio id="bg-music" src="assets/music.mp3" preload="auto" loop></audio>

    <!-- Scripts -->
    <script>
      // Get DOM elements
      const envelope = document.getElementById("envelope");
      const intro = document.getElementById("intro-screen");
      const main = document.getElementById("main-content");
      const music = document.getElementById("bg-music");
      const flash = document.getElementById("flash");

      // Handle envelope click (user interaction)
      envelope.addEventListener("click", () => {
        // Play music (allowed because of user click)
        music.play().catch((err) => {
          console.warn("Autoplay was blocked by browser", err);
          // Optional: show a button to unmute if needed
        });

        // Add open animation to envelope
        envelope.classList.add("open");

        // Flash effect
        flash.style.display = "block";
        flash.classList.add("flash-animate");

        // Hide intro and show main content after animation
        setTimeout(() => {
          intro.style.display = "none";
          main.style.display = "block";
          document.body.style.overflowY = "auto"; // Ensure scrolling is enabled
        }, 900);
      });

      // Countdown timer
      const countdownElement = document.getElementById("countdown");
      const eventDate = new Date("2025-08-23T21:00:00"); // August 23, 2025, 21:00

      function updateCountdown() {
        const now = new Date();
        const diff = eventDate - now;

        if (diff <= 0) {
          countdownElement.innerHTML = "ðŸŽ‰ A festa comeÃ§ou!";
          return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const minutes = Math.floor((diff / (1000 * 60)) % 60);
        const seconds = Math.floor((diff / 1000) % 60);

        countdownElement.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
      }

      setInterval(updateCountdown, 1000);
      updateCountdown();

      // Disco lights effect
      const discoContainer = document.getElementById("disco-lights");
      const colors = ["#ffb3ff", "#b3ffff", "#ffe6b3", "#d9b3ff", "#b3ffb3"];

      function createLight() {
        const light = document.createElement("div");
        light.classList.add("light");
        light.style.left = Math.random() * 100 + "%";
        light.style.top = Math.random() * 100 + "%";
        light.style.backgroundColor =
          colors[Math.floor(Math.random() * colors.length)];
        light.style.animationDuration = 1 + Math.random() * 2 + "s";
        light.style.width = light.style.height = 8 + Math.random() * 12 + "px";
        discoContainer.appendChild(light);

        // Remove light after animation to prevent memory buildup
        setTimeout(() => {
          if (light.parentNode) {
            discoContainer.removeChild(light);
          }
        }, 3000);
      }

      // Adjust light frequency based on device (better performance on mobile)
      const isMobile = window.innerWidth <= 768;
      setInterval(createLight, isMobile ? 500 : 300);

      // Confetti effect (improved visibility)
      function launchConfetti() {
        // Try to create confetti only if supported
        try {
          const confettiColors = [
            "#4caf50",
            "#ffeb3b",
            "#ff5722",
            "#03a9f4",
            "#e91e63",
          ];
          const confettiCount = isMobile ? 80 : 120;

          // Remove any existing confetti container
          const existing = document.querySelector(".confetti-container");
          if (existing) existing.remove();

          const container = document.createElement("div");
          container.className = "confetti-container";
          Object.assign(container.style, {
            position: "fixed",
            top: "0",
            left: "0",
            width: "100%",
            height: "100%",
            pointerEvents: "none",
            zIndex: "1000",
          });
          document.body.appendChild(container);

          // Create confetti pieces
          for (let i = 0; i < confettiCount; i++) {
            const piece = document.createElement("div");
            Object.assign(piece.style, {
              position: "absolute",
              width: `${Math.random() * 8 + 4}px`,
              height: piece.style.width,
              backgroundColor:
                confettiColors[Math.floor(Math.random() * confettiColors.length)],
              top: `${Math.random() * 100}%`,
              left: `${Math.random() * 100}%`,
              opacity: Math.random(),
              transform: `rotate(${Math.random() * 360}deg)`,
              animation: `fall ${Math.random() * 3 + 2}s ease-out forwards`,
            });
            container.appendChild(piece);
          }

          // Clean up after animation
          setTimeout(() => {
            if (container.parentNode) {
              document.body.removeChild(container);
            }
          }, 4000);
        } catch (e) {
          console.warn("Confetti effect failed:", e);
          // Silently fail if not supported
        }
      }

      // Add confetti animation to envelope
      envelope.addEventListener("click", launchConfetti);

      // Define animation for confetti (falling with rotation)
      const style = document.createElement("style");
      style.textContent = `
        @keyframes fall {
          0% {
            transform: translateY(-10vh) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);
    </script>
  </body>
</html>